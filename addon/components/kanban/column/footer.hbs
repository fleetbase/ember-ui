<div class="kanban-column-footer">
    {{#if this.isQuickAdding}}
        {{! Quick add form }}
        <div class="quick-add-form">
            <input
                id="{{@columnId}}-quick-add-input"
                type="text"
                class="quick-add-input"
                placeholder="Enter card title..."
                value={{this.quickAddTitle}}
                {{on "input" (fn (mut this.quickAddTitle) (target-value))}}
                {{on "keydown" this.onQuickAddKeyDown}}
                {{on "blur" this.onQuickAddBlur}}
                aria-label="New card title"
            />
            <div class="quick-add-actions">
                <Button
                    @type="primary"
                    @size="xs"
                    @icon="check"
                    @onClick={{this.saveQuickAdd}}
                    @helpText="Add card"
                    @disabled={{not this.quickAddTitle}}
                />
                <Button
                    @type="secondary"
                    @size="xs"
                    @icon="times"
                    @onClick={{this.cancelQuickAdd}}
                    @helpText="Cancel"
                />
            </div>
        </div>
    {{else}}
        {{! Add card button }}
        <button
            type="button"
            class="add-card-button {{if this.isAtWipLimit 'disabled'}}"
            {{on "click" this.startQuickAdd}}
            disabled={{or @readonly @disabled this.isAtWipLimit}}
            aria-label={{this.addCardButtonHelpText}}
            title={{this.addCardButtonHelpText}}
        >
            {{#if this.isAtWipLimit}}
                <FaIcon @icon="ban" @prefix="fas" class="text-red-500" />
                <span class="text-red-600 dark:text-red-400">{{this.addCardButtonText}}</span>
            {{else}}
                <FaIcon @icon="plus" @prefix="fas" />
                <span>{{this.addCardButtonText}}</span>
            {{/if}}
        </button>

        {{! Advanced options (shown on hover or focus) }}
        {{#unless (or @readonly @disabled this.isAtWipLimit)}}
            <div class="add-card-options">
                {{#if this.hasTemplates}}
                    {{! Card templates dropdown }}
                    <div class="card-templates-dropdown">
                        <Button
                            @type="ghost"
                            @size="xs"
                            @icon="template"
                            @text="Templates"
                            @onClick={{this.toggleTemplates}}
                            @helpText="Create card from template"
                            class="templates-button"
                        />
                        
                        {{#if this.showTemplates}}
                            <div class="templates-menu">
                                {{#each this.cardTemplates as |template|}}
                                    <button
                                        type="button"
                                        class="template-item"
                                        {{on "click" (fn this.onCreateCardWithTemplate template)}}
                                    >
                                        <div class="template-icon">
                                            <FaIcon @icon={{or template.icon "file-alt"}} @prefix="fas" />
                                        </div>
                                        <div class="template-content">
                                            <div class="template-title">{{template.title}}</div>
                                            {{#if template.description}}
                                                <div class="template-description">{{template.description}}</div>
                                            {{/if}}
                                        </div>
                                    </button>
                                {{/each}}
                            </div>
                        {{/if}}
                    </div>
                {{/if}}

                {{! Advanced card creation }}
                <Button
                    @type="ghost"
                    @size="xs"
                    @icon="cog"
                    @text="Advanced"
                    @onClick={{this.onCreateAdvancedCard}}
                    @helpText="Create card with detailed options"
                    class="advanced-button"
                />
            </div>
        {{/unless}}
    {{/if}}

    {{! Column statistics }}
    <div class="column-footer-stats">
        {{#if @column.wipLimit}}
            <div class="wip-limit-indicator">
                <div class="wip-limit-bar">
                    <div
                        class="wip-limit-fill {{if this.isAtWipLimit 'at-limit'}} {{if @column.isOverWipLimit 'over-limit'}}"
                        style="width: {{@column.wipLimitPercentage}}%"
                    ></div>
                </div>
                <span class="wip-limit-text">
                    {{@column.cardCount}}/{{@column.wipLimit}}
                </span>
            </div>
        {{/if}}

        {{! Quick stats }}
        {{#if (gt @column.cardCount 0)}}
            <div class="column-quick-stats">
                {{! Priority distribution }}
                {{#if @column.priorityStats}}
                    <div class="priority-stats">
                        {{#if @column.priorityStats.high}}
                            <span class="priority-indicator high" title="{{@column.priorityStats.high}} high priority">
                                {{@column.priorityStats.high}}
                            </span>
                        {{/if}}
                        {{#if @column.priorityStats.medium}}
                            <span class="priority-indicator medium" title="{{@column.priorityStats.medium}} medium priority">
                                {{@column.priorityStats.medium}}
                            </span>
                        {{/if}}
                        {{#if @column.priorityStats.low}}
                            <span class="priority-indicator low" title="{{@column.priorityStats.low}} low priority">
                                {{@column.priorityStats.low}}
                            </span>
                        {{/if}}
                    </div>
                {{/if}}

                {{! Overdue cards indicator }}
                {{#if @column.overdueCount}}
                    <div class="overdue-indicator" title="{{@column.overdueCount}} overdue cards">
                        <FaIcon @icon="exclamation-triangle" @prefix="fas" class="text-red-500" />
                        <span class="text-red-600 dark:text-red-400 text-xs">{{@column.overdueCount}}</span>
                    </div>
                {{/if}}
            </div>
        {{/if}}
    </div>
</div>
