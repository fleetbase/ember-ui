<div
    class="kanban-board"
    role="application"
    aria-label={{this.boardAriaLabel}}
    aria-describedby="{{this.boardId}}-description"
    {{on "keydown" this.onKeyDown}}
    data-board-id={{this.boardId}}
>
    {{! Screen reader announcements }}
    <div
        id="{{this.boardId}}-announcements"
        class="sr-only"
        aria-live="polite"
        aria-atomic="true"
    >
        {{this.announceText}}
    </div>

    {{! Board description for screen readers }}
    <div id="{{this.boardId}}-description" class="sr-only">
        {{if @description @description "Interactive Kanban board with drag and drop functionality. Use arrow keys to navigate, Enter to select, and keyboard shortcuts for actions."}}
    </div>

    {{! Error display }}
    {{#if this.error}}
        <div class="kanban-error-banner" role="alert">
            <div class="flex items-center justify-between p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg">
                <div class="flex items-center">
                    <FaIcon @icon="exclamation-triangle" @prefix="fas" class="text-red-500 mr-2" />
                    <span class="text-red-700 dark:text-red-300">{{this.error.message}}</span>
                </div>
                <Button
                    @type="secondary"
                    @size="sm"
                    @icon="times"
                    @onClick={{this.clearError}}
                    @helpText="Dismiss error"
                />
            </div>
        </div>
    {{/if}}

    {{! Board header with title and toolbar }}
    <div class="kanban-board-header">
        {{#if @title}}
            <div class="kanban-board-title-section">
                <h1 class="kanban-board-title text-2xl font-semibold text-gray-900 dark:text-gray-100">
                    {{@title}}
                </h1>
                {{#if @subtitle}}
                    <p class="kanban-board-subtitle text-gray-600 dark:text-gray-400 mt-1">
                        {{@subtitle}}
                    </p>
                {{/if}}
            </div>
        {{/if}}

        {{! Toolbar component }}
        <Kanban::Board::Toolbar
            @searchQuery={{this.searchQuery}}
            @filters={{this.filters}}
            @sortBy={{this.sortBy}}
            @sortDirection={{this.sortDirection}}
            @onSearchInput={{this.onSearchInput}}
            @onFilterChange={{this.onFilterChange}}
            @onSortChange={{this.onSortChange}}
            @onClearFilters={{this.clearFilters}}
            @onCreateColumn={{this.onCreateColumn}}
            @boardId={{this.boardId}}
            @disabled={{@disabled}}
            @readonly={{@readonly}}
        />
    </div>

    {{! Loading state }}
    {{#if this.isLoading}}
        <div class="kanban-loading-state" role="status" aria-label="Loading board content">
            <div class="flex items-center justify-center py-12">
                <Spinner @width={{32}} @height={{32}} />
                <span class="ml-3 text-gray-600 dark:text-gray-400">Loading board...</span>
            </div>
        </div>
    {{else}}
        {{! Empty state }}
        {{#if this.isEmpty}}
            <div class="kanban-empty-state" role="status">
                <div class="text-center py-12">
                    <FaIcon @icon="clipboard-list" @prefix="fas" class="text-gray-400 text-4xl mb-4" />
                    <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-2">
                        {{if this.searchQuery "No cards match your search" "No cards yet"}}
                    </h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-6">
                        {{if this.searchQuery 
                            "Try adjusting your search terms or filters" 
                            "Get started by creating your first column and adding cards"
                        }}
                    </p>
                    {{#unless @readonly}}
                        {{#unless this.searchQuery}}
                            <Button
                                @text="Create Column"
                                @icon="plus"
                                @onClick={{this.onCreateColumn}}
                                @type="primary"
                            />
                        {{/unless}}
                    {{/unless}}
                </div>
            </div>
        {{else}}
            {{! Main board content }}
            <div class="kanban-board-content">
                <Kanban::Board::Columns
                    @columns={{this.processedColumns}}
                    @isDragging={{this.isDragging}}
                    @draggedCard={{this.draggedCard}}
                    @draggedColumn={{this.draggedColumn}}
                    @onCardDragStart={{this.onCardDragStart}}
                    @onCardDragEnd={{this.onCardDragEnd}}
                    @onCardDrop={{this.onCardDrop}}
                    @onColumnDragStart={{this.onColumnDragStart}}
                    @onColumnDrop={{this.onColumnDrop}}
                    @onCreateCard={{this.onCreateCard}}
                    @onUpdateCard={{this.onUpdateCard}}
                    @onDeleteCard={{this.onDeleteCard}}
                    @onUpdateColumn={{this.onUpdateColumn}}
                    @onDeleteColumn={{this.onDeleteColumn}}
                    @boardId={{this.boardId}}
                    @disabled={{@disabled}}
                    @readonly={{@readonly}}
                    @cardTemplate={{@cardTemplate}}
                    @columnTemplate={{@columnTemplate}}
                />
            </div>
        {{/if}}
    {{/if}}

    {{! Board footer with stats and pagination }}
    {{#unless this.isEmpty}}
        <Kanban::Board::Footer
            @columns={{this.processedColumns}}
            @totalCards={{this.totalCardCount}}
            @selectedCards={{this.selectedCards}}
            @boardId={{this.boardId}}
        />
    {{/unless}}

    {{! Keyboard shortcuts help (hidden by default) }}
    <div id="{{this.boardId}}-shortcuts" class="sr-only">
        <h3>Keyboard Shortcuts</h3>
        <ul>
            <li>Ctrl/Cmd + F: Focus search</li>
            <li>Ctrl/Cmd + A: Select all cards</li>
            <li>Arrow keys: Navigate between cards and columns</li>
            <li>Enter: Select/activate focused element</li>
            <li>Space: Toggle selection</li>
            <li>Escape: Cancel current action</li>
        </ul>
    </div>
</div>
